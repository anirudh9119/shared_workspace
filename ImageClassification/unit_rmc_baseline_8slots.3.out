Running on g039
128key_LnNoDropLSTM-default-data-cifar10-version-0-num_layers-4-num_templates-4-dropout-0.1-epochs-200-patch_size-4-num_heads-4-batch_size-64-lr-0.0001-256-512-2-2-True-6-True-True-10-True-1-8
Files already downloaded and verified
Files already downloaded and verified
line 153
transformer embed_dim 256
functional? False
total heads 4
head dim 64
use topk?True
topk:10
MEM SLOTS:8
Null attention:False
NEW !!! USING SHARED MEMORY ATTENTION +++++++++
Using gate style unit
query:32896
key:32896
value:65792
attention_mlp:65792
layernorm1:512
layernorm2:512
input_projector:65792
input projector:256
input_gate_projector:208640
memory_gate_projector:1052672
relational volatie!!!
64
32
4
48
torch.Size([])
torch.Size([])
torch.Size([128, 256])
torch.Size([128])
torch.Size([128, 256])
torch.Size([128])
torch.Size([256, 256])
torch.Size([256])
torch.Size([256, 256])
torch.Size([256])
torch.Size([256])
torch.Size([256])
torch.Size([256])
torch.Size([256])
torch.Size([256, 256])
torch.Size([256])
torch.Size([256])
torch.Size([1, 300, 256])
torch.Size([512, 256])
torch.Size([512])
torch.Size([8, 256, 512])
torch.Size([8, 512])
Total number of rmc_parameters:1525506
Total number of parameters:1958412

Epoch: 0
[1,   100] loss: 2.087 accuracy:22.828
[1,   200] loss: 1.994 accuracy:25.602
[1,   300] loss: 1.940 accuracy:27.776
[1,   400] loss: 1.899 accuracy:29.086
[1,   500] loss: 1.866 accuracy:30.531
[1,   600] loss: 1.838 accuracy:31.615
[1,   700] loss: 1.816 accuracy:32.482
test_accuracy is 39.880 after epochs 0
Saving..

Epoch: 1
[2,   100] loss: 1.643 accuracy:39.375
[2,   200] loss: 1.625 accuracy:40.617
[2,   300] loss: 1.620 accuracy:40.724
[2,   400] loss: 1.614 accuracy:40.766
[2,   500] loss: 1.601 accuracy:41.297
[2,   600] loss: 1.590 accuracy:41.760
[2,   700] loss: 1.583 accuracy:42.004
test_accuracy is 46.490 after epochs 1
Saving..

Epoch: 2
[3,   100] loss: 1.509 accuracy:44.922
[3,   200] loss: 1.502 accuracy:45.414
[3,   300] loss: 1.497 accuracy:45.651
[3,   400] loss: 1.490 accuracy:45.988
[3,   500] loss: 1.480 accuracy:46.309
[3,   600] loss: 1.474 accuracy:46.586
[3,   700] loss: 1.470 accuracy:46.672
test_accuracy is 47.820 after epochs 2
Saving..

Epoch: 3
[4,   100] loss: 1.393 accuracy:50.016
[4,   200] loss: 1.398 accuracy:49.609
[4,   300] loss: 1.399 accuracy:49.521
[4,   400] loss: 1.399 accuracy:49.426
[4,   500] loss: 1.399 accuracy:49.219
[4,   600] loss: 1.394 accuracy:49.307
[4,   700] loss: 1.393 accuracy:49.279
test_accuracy is 51.850 after epochs 3
Saving..

Epoch: 4
[5,   100] loss: 1.358 accuracy:50.891
[5,   200] loss: 1.352 accuracy:51.008
[5,   300] loss: 1.343 accuracy:51.370
[5,   400] loss: 1.344 accuracy:51.492
[5,   500] loss: 1.343 accuracy:51.597
[5,   600] loss: 1.342 accuracy:51.536
[5,   700] loss: 1.337 accuracy:51.710
test_accuracy is 53.220 after epochs 4
Saving..

Epoch: 5
[6,   100] loss: 1.305 accuracy:52.734
[6,   200] loss: 1.301 accuracy:52.523
[6,   300] loss: 1.307 accuracy:52.552
[6,   400] loss: 1.305 accuracy:52.621
[6,   500] loss: 1.300 accuracy:52.812
[6,   600] loss: 1.293 accuracy:53.115
[6,   700] loss: 1.297 accuracy:53.132
test_accuracy is 54.470 after epochs 5
Saving..

Epoch: 6
[7,   100] loss: 1.277 accuracy:53.797
[7,   200] loss: 1.280 accuracy:53.750
[7,   300] loss: 1.274 accuracy:53.781
[7,   400] loss: 1.271 accuracy:54.133
[7,   500] loss: 1.270 accuracy:54.228
[7,   600] loss: 1.266 accuracy:54.302
[7,   700] loss: 1.261 accuracy:54.500
test_accuracy is 56.610 after epochs 6
Saving..

Epoch: 7
[8,   100] loss: 1.238 accuracy:55.062
[8,   200] loss: 1.234 accuracy:55.359
[8,   300] loss: 1.223 accuracy:55.854
[8,   400] loss: 1.227 accuracy:55.742
[8,   500] loss: 1.227 accuracy:55.747
[8,   600] loss: 1.227 accuracy:55.648
[8,   700] loss: 1.227 accuracy:55.556
test_accuracy is 57.420 after epochs 7
Saving..

Epoch: 8
